from jaqsmds.server.repliers.basic import RegularReplier
from jaqsmds.server.repliers.handlers import JsetHandler, JsdHandler, JsiHandler


class FreeReplier(RegularReplier):

    def __init__(self):
        super(FreeReplier, self).__init__()
        self.jset = JsetHandler()
        self.jsd = JsdHandler()
        self.jsi = JsiHandler()
        self.methods["jset.query"] = self.jset.handle
        self.methods["jsd.query"] = self.jsd.handle
        self.methods["jsi.query"] = self.jsi.handle


if __name__ == '__main__':
    from datautils.fxdayu import instance
    instance.init("192.168.0.102")

    msg = {'jsonrpc': '2.0', 'method': 'jsd.query', 'params': {'symbol': '000001.SZ,000002.SZ,000005.SZ,000006.SZ,000009.SZ,000012.SZ,000016.SZ,000021.SZ,000022.SZ,000024.SZ,000027.SZ,000028.SZ,000029.SZ,000031.SZ,000032.SZ,000039.SZ,000040.SZ,000042.SZ,000046.SZ,000050.SZ,000059.SZ,000060.SZ,000061.SZ,000062.SZ,000063.SZ,000066.SZ,000068.SZ,000069.SZ,000078.SZ,000089.SZ,000090.SZ,000099.SZ,000100.SZ,000151.SZ,000155.SZ,000157.SZ,000158.SZ,000159.SZ,000301.SZ,000338.SZ,000400.SZ,000401.SZ,000402.SZ,000407.SZ,000410.SZ,000416.SZ,000417.SZ,000419.SZ,000421.SZ,000422.SZ,000423.SZ,000425.SZ,000426.SZ,000428.SZ,000429.SZ,000488.SZ,000501.SZ,000503.SZ,000504.SZ,000507.SZ,000510.SZ,000511.SZ,000513.SZ,000514.SZ,000520.SZ,000522.SZ,000525.SZ,000527.SZ,000528.SZ,000532.SZ,000533.SZ,000537.SZ,000538.SZ,000540.SZ,000541.SZ,000543.SZ,000548.SZ,000550.SZ,000554.SZ,000559.SZ,000562.SZ,000563.SZ,000565.SZ,000568.SZ,000571.SZ,000572.SZ,000573.SZ,000581.SZ,000584.SZ,000589.SZ,000594.SZ,000597.SZ,000598.SZ,000599.SZ,000600.SZ,000601.SZ,000602.SZ,000607.SZ,000608.SZ,000609.SZ,000612.SZ,000616.SZ,000617.SZ,000619.SZ,000623.SZ,000625.SZ,000627.SZ,000629.SZ,000630.SZ,000651.SZ,000652.SZ,000655.SZ,000659.SZ,000666.SZ,000667.SZ,000677.SZ,000679.SZ,000680.SZ,000682.SZ,000683.SZ,000685.SZ,000686.SZ,000687.SZ,000690.SZ,000695.SZ,000698.SZ,000707.SZ,000708.SZ,000709.SZ,000712.SZ,000713.SZ,000717.SZ,000718.SZ,000725.SZ,000726.SZ,000727.SZ,000728.SZ,000729.SZ,000731.SZ,000733.SZ,000735.SZ,000737.SZ,000748.SZ,000755.SZ,000758.SZ,000759.SZ,000762.SZ,000768.SZ,000777.SZ,000778.SZ,000783.SZ,000786.SZ,000792.SZ,000793.SZ,000799.SZ,000800.SZ,000807.SZ,000815.SZ,000816.SZ,000818.SZ,000819.SZ,000822.SZ,000823.SZ,000825.SZ,000826.SZ,000828.SZ,000829.SZ,000830.SZ,000831.SZ,000837.SZ,000839.SZ,000850.SZ,000852.SZ,000858.SZ,000859.SZ,000860.SZ,000875.SZ,000876.SZ,000877.SZ,000878.SZ,000881.SZ,000882.SZ,000886.SZ,000887.SZ,000895.SZ,000897.SZ,000898.SZ,000899.SZ,000900.SZ,000903.SZ,000905.SZ,000910.SZ,000911.SZ,000912.SZ,000916.SZ,000917.SZ,000919.SZ,000926.SZ,000927.SZ,000930.SZ,000931.SZ,000932.SZ,000933.SZ,000936.SZ,000937.SZ,000938.SZ,000939.SZ,000949.SZ,000950.SZ,000951.SZ,000952.SZ,000959.SZ,000960.SZ,000962.SZ,000963.SZ,000968.SZ,000969.SZ,000970.SZ,000972.SZ,000973.SZ,000975.SZ,000976.SZ,000978.SZ,000983.SZ,000987.SZ,000988.SZ,000989.SZ,000990.SZ,000996.SZ,000997.SZ,000998.SZ,000999.SZ,001696.SZ,002001.SZ,002008.SZ,002011.SZ,002018.SZ,002019.SZ,002024.SZ,002028.SZ,002029.SZ,002038.SZ,002041.SZ,002048.SZ,002052.SZ,002053.SZ,002056.SZ,002062.SZ,002064.SZ,002065.SZ,002069.SZ,002073.SZ,002083.SZ,002092.SZ,002093.SZ,002097.SZ,002110.SZ,002122.SZ,002123.SZ,002128.SZ,002129.SZ,002133.SZ,002142.SZ,002146.SZ,002147.SZ,002154.SZ,002155.SZ,002161.SZ,002172.SZ,002181.SZ,002182.SZ,002183.SZ,002186.SZ,002187.SZ,002191.SZ,002194.SZ,002200.SZ,002202.SZ,002203.SZ,002204.SZ,002216.SZ,002218.SZ,002230.SZ,002233.SZ,002237.SZ,002238.SZ,002241.SZ,002242.SZ,002244.SZ,002249.SZ,002251.SZ,002252.SZ,002254.SZ,002266.SZ,002267.SZ,002269.SZ,002274.SZ,600000.SH,600001.SH,600004.SH,600005.SH,600006.SH,600008.SH,600009.SH,600010.SH,600011.SH,600012.SH,600015.SH,600016.SH,600017.SH,600018.SH,600019.SH,600022.SH,600026.SH,600027.SH,600028.SH,600029.SH,600030.SH,600031.SH,600033.SH,600035.SH,600036.SH,600037.SH,600038.SH,600039.SH,600048.SH,600050.SH,600051.SH,600052.SH,600054.SH,600056.SH,600058.SH,600059.SH,600060.SH,600061.SH,600063.SH,600064.SH,600066.SH,600067.SH,600068.SH,600069.SH,600072.SH,600073.SH,600074.SH,600075.SH,600078.SH,600079.SH,600082.SH,600085.SH,600086.SH,600087.SH,600088.SH,600089.SH,600096.SH,600100.SH,600102.SH,600103.SH,600104.SH,600106.SH,600107.SH,600108.SH,600109.SH,600110.SH,600111.SH,600117.SH,600118.SH,600120.SH,600121.SH,600122.SH,600123.SH,600125.SH,600126.SH,600127.SH,600128.SH,600129.SH,600131.SH,600132.SH,600135.SH,600138.SH,600141.SH,600143.SH,600150.SH,600151.SH,600153.SH,600156.SH,600158.SH,600159.SH,600160.SH,600162.SH,600163.SH,600166.SH,600168.SH,600169.SH,600170.SH,600171.SH,600176.SH,600177.SH,600178.SH,600179.SH,600183.SH,600186.SH,600188.SH,600189.SH,600190.SH,600191.SH,600192.SH,600195.SH,600196.SH,600197.SH,600201.SH,600202.SH,600206.SH,600208.SH,600210.SH,600215.SH,600216.SH,600219.SH,600220.SH,600221.SH,600226.SH,600227.SH,600230.SH,600231.SH,600236.SH,600237.SH,600239.SH,600240.SH,600246.SH,600249.SH,600251.SH,600255.SH,600256.SH,600258.SH,600260.SH,600261.SH,600263.SH,600266.SH,600268.SH,600269.SH,600270.SH,600271.SH,600276.SH,600277.SH,600278.SH,600279.SH,600281.SH,600282.SH,600284.SH,600287.SH,600288.SH,600289.SH,600290.SH,600291.SH,600292.SH,600293.SH,600298.SH,600299.SH,600300.SH,600307.SH,600308.SH,600309.SH,600312.SH,600316.SH,600317.SH,600320.SH,600322.SH,600323.SH,600325.SH,600326.SH,600327.SH,600328.SH,600330.SH,600331.SH,600332.SH,600333.SH,600337.SH,600339.SH,600343.SH,600348.SH,600350.SH,600352.SH,600357.SH,600358.SH,600359.SH,600360.SH,600361.SH,600362.SH,600363.SH,600366.SH,600367.SH,600376.SH,600380.SH,600382.SH,600383.SH,600386.SH,600387.SH,600388.SH,600389.SH,600391.SH,600393.SH,600395.SH,600396.SH,600398.SH,600399.SH,600400.SH,600406.SH,600408.SH,600409.SH,600410.SH,600415.SH,600416.SH,600418.SH,600420.SH,600422.SH,600423.SH,600425.SH,600426.SH,600428.SH,600432.SH,600435.SH,600436.SH,600439.SH,600449.SH,600456.SH,600458.SH,600459.SH,600460.SH,600467.SH,600468.SH,600469.SH,600470.SH,600475.SH,600478.SH,600479.SH,600480.SH,600481.SH,600482.SH,600486.SH,600487.SH,600488.SH,600489.SH,600491.SH,600496.SH,600497.SH,600498.SH,600499.SH,600500.SH,600501.SH,600503.SH,600507.SH,600508.SH,600509.SH,600510.SH,600512.SH,600516.SH,600518.SH,600519.SH,600521.SH,600522.SH,600523.SH,600525.SH,600528.SH,600529.SH,600530.SH,600531.SH,600533.SH,600535.SH,600540.SH,600546.SH,600547.SH,600548.SH,600549.SH,600550.SH,600553.SH,600555.SH,600557.SH,600563.SH,600565.SH,600567.SH,600569.SH,600578.SH,600580.SH,600581.SH,600582.SH,600583.SH,600584.SH,600585.SH,600586.SH,600588.SH,600589.SH,600590.SH,600592.SH,600594.SH,600595.SH,600596.SH,600597.SH,600598.SH,600600.SH,600601.SH,600606.SH,600607.SH,600609.SH,600611.SH,600616.SH,600618.SH,600620.SH,600621.SH,600622.SH,600624.SH,600626.SH,600628.SH,600629.SH,600630.SH,600631.SH,600635.SH,600636.SH,600637.SH,600638.SH,600639.SH,600640.SH,600641.SH,600642.SH,600643.SH,600649.SH,600650.SH,600651.SH,600652.SH,600653.SH,600654.SH,600655.SH,600660.SH,600662.SH,600663.SH,600664.SH,600665.SH,600667.SH,600673.SH,600674.SH,600675.SH,600676.SH,600677.SH,600682.SH,600683.SH,600685.SH,600686.SH,600688.SH,600690.SH,600692.SH,600693.SH,600694.SH,600702.SH,600703.SH,600704.SH,600707.SH,600708.SH,600710.SH,600713.SH,600717.SH,600718.SH,600720.SH,600723.SH,600724.SH,600725.SH,600726.SH,600729.SH,600732.SH,600736.SH,600737.SH,600739.SH,600740.SH,600741.SH,600744.SH,600746.SH,600748.SH,600750.SH,600754.SH,600759.SH,600761.SH,600765.SH,600770.SH,600775.SH,600776.SH,600777.SH,600779.SH,600780.SH,600782.SH,600787.SH,600789.SH,600790.SH,600795.SH,600797.SH,600798.SH,600801.SH,600802.SH,600804.SH,600805.SH,600806.SH,600808.SH,600809.SH,600810.SH,600811.SH,600812.SH,600814.SH,600815.SH,600816.SH,600820.SH,600821.SH,600823.SH,600824.SH,600826.SH,600827.SH,600829.SH,600830.SH,600831.SH,600832.SH,600835.SH,600836.SH,600837.SH,600838.SH,600839.SH,600844.SH,600846.SH,600851.SH,600855.SH,600858.SH,600859.SH,600861.SH,600864.SH,600866.SH,600867.SH,600872.SH,600874.SH,600875.SH,600877.SH,600879.SH,600880.SH,600881.SH,600883.SH,600884.SH,600886.SH,600888.SH,600894.SH,600895.SH,600896.SH,600897.SH,600900.SH,600961.SH,600962.SH,600963.SH,600965.SH,600966.SH,600970.SH,600971.SH,600973.SH,600978.SH,600981.SH,600983.SH,600987.SH,600991.SH,600995.SH,600997.SH,601001.SH,601002.SH,601005.SH,601006.SH,601009.SH,601088.SH,601111.SH,601166.SH,601168.SH,601169.SH,601186.SH,601318.SH,601328.SH,601333.SH,601390.SH,601398.SH,601588.SH,601600.SH,601601.SH,601607.SH,601628.SH,601666.SH,601699.SH,601727.SH,601766.SH,601808.SH,601857.SH,601866.SH,601872.SH,601898.SH,601899.SH,601918.SH,601919.SH,601939.SH,601958.SH,601988.SH,601991.SH,601998.SH,601999.SH', 'fields': 'close,volume,trade_date,high_adj,vwap,high,vwap_adj,low_adj,open,trade_status,symbol,low,close_adj,open_adj', 'begin_date': 20091106, 'end_date': 20100522, 'adjust_mode': 'none', 'freq': '1d'}, 'id': '383'}
    rep = FreeReplier()
    print(rep.handle(msg)["error"])